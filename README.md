# PDF 阅读器

基于 Fyne + go-fitz 开发的现代化 PDF 阅读器，支持多标签页。

## 功能特性

### 核心功能
- ✅ 打开和阅读 PDF 文件
- ✅ **多标签页支持** - 同时打开多个 PDF 文件，Tab 切换 ⭐ **v1.1 新增**
- ✅ 页面导航（上一页/下一页/首页/末页/页码跳转）
- ✅ 缩放功能（50%-300%：放大/缩小/重置）
- ✅ 键盘快捷键支持
- ✅ 跨平台（Windows/Linux/macOS）

### 多标签页功能 (v1.1) ⭐
- ✅ **同时打开多个 PDF** - 每个文件独立标签页
- ✅ **智能标签管理** - 空标签页自动复用，避免多余标签 ⭐ **v1.1.1 优化**
- ✅ **标签页切换** - 点击标签或快捷键切换
- ✅ **独立状态管理** - 每个标签独立页码和缩放
- ✅ **标签页管理** - 新建、关闭标签页
- ✅ **文件名显示** - 标签页标题显示文件名

### 界面增强 (v1.0)
- ✅ **标准菜单栏**
  - 文件菜单：打开、新建标签页、关闭标签页、退出
  - 查看菜单：导航和缩放选项
  - 帮助菜单：快捷键说明、关于信息
- ✅ **图标化工具栏** - 美观的图标按钮替代文字
- ✅ **鼠标滚轮翻页** - 向上/向下滚动翻页
- ✅ **双击打开文件** - 空白区域双击调出文件选择对话框
- ✅ **增强状态栏** - 显示文件名、页码、缩放比例、文件大小
- ✅ **精美程序图标** - 现代简约的 PDF 文档图标

## Windows 编译

### 前置要求

1. 安装 Go 1.19 或更高版本
2. 安装 GCC 编译器（推荐使用 TDM-GCC 或 MinGW-w64）
   - 下载 TDM-GCC: https://jmeubank.github.io/tdm-gcc/
   - 或下载 MinGW-w64: https://www.mingw-w64.org/

### 编译步骤

```bash
# 1. 进入项目根目录
cd /path/to/pdfviewer
# 2. 下载依赖
go mod download

# 3. 编译（在项目根目录执行）
go build -o pdfviewer.exe ./pdfviewer

# 或者使用 PowerShell
go build -o bin\pdfviewer.exe .\pdfviewer
```

### 构建优化版本（减小体积）

```bash
go build -ldflags="-s -w" -o pdfviewer.exe ./pdfviewer
```

## 使用方法

### 启动应用

```bash
# 方式 1: 直接运行（会显示文件选择对话框或双击空白区域）
pdfviewer.exe

# 方式 2: 指定 PDF 文件路径
pdfviewer.exe document.pdf
```

### 界面操作

#### 多标签页 (v1.1 新增) ⭐
- **打开多个文件** - 菜单→文件→打开，每次打开创建新标签页
- **新建标签页** - 菜单→文件→新建标签页，创建空标签
- **切换标签页** - 点击标签页标题切换
- **关闭标签页** - 菜单→文件→关闭标签页，关闭当前标签
- **独立操作** - 每个标签页独立翻页和缩放

#### 菜单栏
- **文件菜单**
  - 打开... - 选择 PDF 文件（创建新标签页）
  - 新建标签页 - 创建空标签页
  - 另存为... - 保存当前文档副本到新位置
  - 关闭标签页 - 关闭当前标签页
  - 退出 - 退出程序

- **查看菜单**
  - 首页/上一页/下一页/末页 - 页面导航（操作当前标签页）
  - 放大/缩小/实际大小 - 缩放控制（操作当前标签页）

- **帮助菜单**
  - 快捷键 - 查看所有快捷键
  - 关于 - 查看版本和许可信息

#### 工具栏（图标化）
- 📂 打开按钮 - 选择要打开的 PDF 文件（创建新标签页）
- 💾 另存为按钮 - 保存当前文档副本到新位置
- ❌ 关闭标签按钮 - 关闭当前标签页（v1.2.2 新增）
- ⏮️ 首页 - 跳转到第一页（当前标签）
- ◀️ 上一页 - 翻到上一页（当前标签）
- ▶️ 下一页 - 翻到下一页（当前标签）
- ⏭️ 末页 - 跳转到最后一页（当前标签）
- 🔍➖ 缩小 - 减小缩放比例（当前标签）
- 100% - 重置为实际大小（当前标签）
- 🔍➕ 放大 - 增大缩放比例（当前标签）
- 页码输入框 - 输入页码后按 Enter 跳转（当前标签）

#### 鼠标操作
- **滚轮翻页** - 向上滚动翻到上一页，向下滚动翻到下一页（当前标签）
- **双击空白** - 未打开文档时，双击空白区域打开文件选择对话框

#### 状态栏
显示当前激活标签页的详细文档信息：
```
document.pdf  |  第 5 / 120 页  |  缩放: 125%  |  大小: 3.2 MB
```

### 键盘快捷键

- `左箭头` / `PageUp`: 上一页
- `右箭头` / `PageDown` / `空格`: 下一页
- `Home`: 跳转到首页
- `End`: 跳转到末页
- `Ctrl+W`: 关闭当前标签页（v1.2.2 新增）

### 界面操作

- **打开按钮**: 选择要打开的 PDF 文件
- **导航按钮**: 首页、上一页、下一页、末页
- **页码输入框**: 输入页码后按 Enter 跳转
- **缩放按钮**: `-` 缩小、`100%` 重置、`+` 放大

## 项目结构

```
cmd/pdfviewer/
├── main.go              # 程序入口
├── ui.go                # 用户界面（菜单、工具栏、事件处理）
├── controller.go        # 控制器逻辑（页面管理、缩放控制）
├── pdf_engine.go        # PDF 引擎（go-fitz 封装）
├── theme.go             # 主题配置
├── icon.go              # 程序图标生成
├── README.md            # 使用说明
```

## 技术亮点

1. **KISS 原则** - 代码简洁易维护，约 1000 行
2. **模块化设计** - 界面/控制/引擎分离
3. **自定义 Widget** - 实现滚轮翻页和双击事件
4. **代码生成图标** - 无需外部图片资源
5. **跨平台支持** - Windows/Linux/macOS 一次编译

## 依赖说明

- **Fyne**: GUI 框架（v2.4+）
- **go-fitz**: MuPDF 的 Go 封装，用于 PDF 渲染（AGPL 许可）

## 项目结构

```
cmd/pdfviewer/
├── main.go          # 程序入口
├── pdf_engine.go    # PDF 引擎（go-fitz 封装）
├── controller.go    # 控制器逻辑
├── ui.go            # 用户界面
├── theme.go         # 主题配置
└── README.md        # 本文件
```

## 常见问题

### Q: 编译时报错 "gcc: command not found"
A: 需要安装 GCC 编译器，并确保已添加到系统 PATH。

### Q: 编译时报错链接器错误
A: 确保使用 64 位版本的 GCC，并且版本与 Go 版本兼容。

### Q: 打开 PDF 文件失败
A: 确保 PDF 文件未损坏，且不是加密的 PDF。

### Q: 页面渲染缓慢
A: 可以降低 DPI 设置（修改 controller.go 中的 baseDPI 值）。


## 许可证

- go-fitz: AGPL-3.0
- Fyne: BSD-3-Clause

## 联系方式

如有问题，请查阅 Fyne 和 go-fitz 的官方文档：
- Fyne: https://fyne.io/
- go-fitz: https://github.com/gen2brain/go-fitz
